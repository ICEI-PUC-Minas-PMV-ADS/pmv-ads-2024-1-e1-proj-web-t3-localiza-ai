<!DOCTYPE html>
<html dir="ltr" lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Modelo de painel de controle, inspirado no Framework Bootstrap">
    <meta name="robots" content="noindex,nofollow">
    <title>Localiza.Ai - Clientes</title>
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/images/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/mdi.min.css">
    <link href="../../assets/libs/chartist/dist/chartist.min.css" rel="stylesheet">
    <link href="../../dist/css/style.min.css" rel="stylesheet">
</head>

<body>
    <div id="main-wrapper" data-navbarbg="skin6" data-theme="light" data-layout="vertical" data-sidebartype="full"
        data-boxed-layout="full">
        <header class="topbar" data-navbarbg="skin6">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <div class="navbar-header" data-logobg="skin5">
                    <a class="nav-toggler waves-effect waves-light d-block d-md-none" href="javascript:void(0)">
                        <i class="ti-menu ti-close"></i>
                    </a>
                    <div class="navbar-brand">
                        <a href="index.html" class="logo">
                            <span class="logo-text">
                                <img src="../../assets/images/logo-text.png" alt="homepage" class="dark-logo" />
                                <img src="../../assets/images/logo-light-text.png" class="light-logo" alt="homepage" />
                            </span>
                        </a>
                    </div>
                </div>
                <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin6">
                    <ul class="navbar-nav float-start me-auto">
                        <li class="nav-item search-box">
                            <a class="nav-link waves-effect waves-dark" href="javascript:void(0)">
                                <div class="d-flex align-items-center">
                                    <i class="mdi mdi-magnify font-20 me-1"></i>
                                    <div class="ms-1 d-none d-sm-block">
                                        <span>Pesquise aqui</span>
                                    </div>
                                </div>
                            </a>
                            <form class="app-search position-absolute">
                                <input type="text" class="form-control" placeholder="Digite serviços, orçamentos e muito mais">
                                <a class="srh-btn"><i class="ti-close"></i></a>
                            </form>
                        </li>
                    </ul>
                    <ul class="navbar-nav float-end">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark pro-pic" href="#" id="navbarDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="../../assets/images/users/1.jpg" alt="user" class="rounded-circle" width="40">
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end user-dd animated" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="javascript:void(0)"><i class="ti-user me-1 ms-1"></i> Status: Online</a>
                                <a class="dropdown-item" href="javascript:void(0)"><i class="ti-user me-1 ms-1"></i> Configurações de conta</a>
                                <a class="dropdown-item" href="javascript:void(0)"><i class="ti-user me-1 ms-1"></i> Feedback</a>
                                <a class="dropdown-item" href="javascript:void(0)"><i class="ti-user me-1 ms-1"></i> Logout</a>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <aside class="left-sidebar" data-sidebarbg="skin5">
            <div class="scroll-sidebar">
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="index.html" aria-expanded="false">
                                <i class="mdi mdi-home"></i>
                                <span class="hide-menu">Página Inicial</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="inbox.html" aria-expanded="false">
                                <i class="mdi mdi-android-messages"></i>
                                <span class="hide-menu">Inbox</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="servicos.html" aria-expanded="false">
                                <i class="mdi mdi-window-shutter-settings"></i>
                                <span class="hide-menu">Serviços</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="orcamentos.html" aria-expanded="false">
                                <i class="mdi mdi-invoice-edit"></i>
                                <span class="hide-menu">Orçamentos</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link active" href="clientes.html" aria-expanded="false">
                                <i class="mdi mdi-contacts"></i>
                                <span class="hide-menu">Clientes</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="ajuda.html" aria-expanded="false">
                                <i class="mdi mdi-frequently-asked-questions"></i>
                                <span class="hide-menu">Central de Ajuda</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="configuracoes.html" aria-expanded="false">
                                <i class="mdi mdi-cog-outline"></i>
                                <span class="hide-menu">Configurações</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>
        <div class="page-wrapper">
            <div class="page-breadcrumb">
                <div class="row">
                    <div class="col-5 align-self-center">
                        <h4 class="page-title">Clientes</h4>
                    </div>
                    <div class="col-7 align-self-center">
                        <div class="d-flex align-items-center justify-content-end">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="#">Página Inicial</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">Clientes</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title">Lista de Clientes</h4>
                                <div class="d-flex justify-content-end mb-3">
                                    <button class="btn btn-primary" onclick="showCreateForm()">Criar Contato</button>
                                </div>
                                <div class="row" id="clientsList">
                                    <!-- Lista de clientes será preenchida aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer text-center">
                Todos os direitos reservados a Equipe 2 (Alanis, Felipe, Lucas e Tais). Projetado e desenvolvido por
                <a href="https://github.com/ICEI-PUC-Minas-PMV-ADS/pmv-ads-2024-1-e1-proj-web-t3-localiza-ai">Localiza.Ai (Github)</a>.
            </footer>
        </div>
    </div>
    <div id="createClientModal" style="display:none;">
        <div class="modal-content">
            <span class="close" onclick="closeCreateForm()">&times;</span>
            <h2>Criar Novo Contato</h2>
            <form id="clientForm">
                <div class="form-group">
                    <label for="isActive">Ativo</label>
                    <input type="checkbox" id="isActive">
                </div>
                <div class="form-group">
                    <label for="clientType">Tipo de Cliente</label>
                    <div>
                        <input type="radio" id="pf" name="clientType" value="Pessoa Física" checked>
                        <label for="pf">Pessoa Física</label>
                        <input type="radio" id="pj" name="clientType" value="Pessoa Jurídica">
                        <label for="pj">Pessoa Jurídica</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="fullName">Nome</label>
                    <input type="text" class="form-control" id="fullName" required>
                </div>
                <div class="form-group">
                    <label for="cpf">CPF</label>
                    <input type="text" class="form-control" id="cpf" required>
                </div>
                <div class="form-group">
                    <label for="dob">Data de Nascimento</label>
                    <input type="date" class="form-control" id="dob" required>
                </div>
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" class="form-control" id="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Telefone</label>
                    <input type="text" class="form-control" id="phone" required>
                </div>
                <div class="form-group">
                    <label for="cep">CEP</label>
                    <input type="text" class="form-control" id="cep" required>
                    <button type="button" onclick="fetchAddress()">Buscar</button>
                </div>
                <div class="form-group">
                    <label for="city">Cidade</label>
                    <input type="text" class="form-control" id="city" readonly>
                </div>
                <div class="form-group">
                    <label for="address">Endereço</label>
                    <input type="text" class="form-control" id="address" readonly>
                </div>
                <div class="form-group">
                    <label for="neighborhood">Bairro</label>
                    <input type="text" class="form-control" id="neighborhood" readonly>
                </div>
                <div class="form-group">
                    <label for="number">Número</label>
                    <input type="text" class="form-control" id="number" required>
                </div>
                <div class="form-group">
                    <label for="complement">Complemento</label>
                    <input type="text" class="form-control" id="complement">
                </div>
                <button type="submit" class="btn btn-primary">Salvar</button>
                <button type="button" class="btn btn-secondary" onclick="closeCreateForm()">Cancelar</button>
            </form>
        </div>
    </div>
    <style>
        #createClientModal {
            position: fixed;
            z-index: 1;
            padding-top: 60px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            loadClients();
            document.getElementById("clientForm").addEventListener("submit", function (event) {
                event.preventDefault();
                saveClient();
            });
        });

        function showCreateForm() {
            document.getElementById("createClientModal").style.display = "block";
        }

        function closeCreateForm() {
            document.getElementById("createClientModal").style.display = "none";
        }

        function fetchAddress() {
            const cep = document.getElementById("cep").value.replace("-", "").replace(".", "");
            if (cep.length !== 8) {
                alert("CEP inválido!");
                return;
            }
            fetch(`https://viacep.com.br/ws/${cep}/json/`)
                .then(response => response.json())
                .then(data => {
                    if (data.erro) {
                        alert("CEP não encontrado!");
                    } else {
                        document.getElementById("city").value = data.localidade;
                        document.getElementById("address").value = data.logradouro;
                        document.getElementById("neighborhood").value = data.bairro;
                    }
                })
                .catch(() => {
                    alert("Erro ao buscar o CEP!");
                });
        }

        function saveClient() {
            const isActive = document.getElementById("isActive").checked;
            const clientType = document.querySelector('input[name="clientType"]:checked').value;
            const fullName = document.getElementById("fullName").value;
            const cpf = document.getElementById("cpf").value;
            const dob = document.getElementById("dob").value;
            const email = document.getElementById("email").value;
            const phone = document.getElementById("phone").value;
            const cep = document.getElementById("cep").value;
            const city = document.getElementById("city").value;
            const address = document.getElementById("address").value;
            const neighborhood = document.getElementById("neighborhood").value;
            const number = document.getElementById("number").value;
            const complement = document.getElementById("complement").value;

            const client = {
                isActive,
                clientType,
                fullName,
                cpf,
                dob,
                email,
                phone,
                cep,
                city,
                address,
                neighborhood,
                number,
                complement
            };

            let clients = localStorage.getItem("clients");
            if (clients) {
                clients = JSON.parse(clients);
            } else {
                clients = [];
            }
            clients.push(client);
            localStorage.setItem("clients", JSON.stringify(clients));
            closeCreateForm();
            loadClients();
        }

        function loadClients() {
            const clientsList = document.getElementById("clientsList");
            clientsList.innerHTML = "";
            let clients = localStorage.getItem("clients");
            if (clients) {
                clients = JSON.parse(clients);
                clients.forEach((client, index) => {
                    const clientCard = document.createElement("div");
                    clientCard.className = "col-md-6 col-lg-4";
                    clientCard.innerHTML = `
                        <div class="card border">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="ms-3">
                                        <h5 class="mb-0">${client.fullName}</h5>
                                        <p class="text-muted mb-0">${client.address}</p>
                                        <p class="text-muted mb-0">Telefone : ${client.phone}</p>
                                        <p class="text-muted mb-0">Número : ${client.number}</p>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <button class="btn btn-sm btn-outline-primary" onclick="editClient(${index})">Editar</button>
                                    <button class="btn btn-sm btn-outline-success" onclick="sendMessage(${index})">Enviar Mensagem</button>
                                    <button class="btn btn-sm btn-outline-danger" onclick="deleteClient(${index})">Excluir</button>
                                </div>
                            </div>
                        </div>
                    `;
                    clientsList.appendChild(clientCard);
                });
            }
        }

        function editClient(index) {
            // Função para editar cliente (a ser implementada)
        }

        function sendMessage(index) {
            window.location.href = `inbox.html?client=${index}`;
        }

        function deleteClient(index) {
            let clients = localStorage.getItem("clients");
            if (clients) {
                clients = JSON.parse(clients);
                clients.splice(index, 1);
                localStorage.setItem("clients", JSON.stringify(clients));
                loadClients();
            }
        }
    </script>
</body>

</html>
